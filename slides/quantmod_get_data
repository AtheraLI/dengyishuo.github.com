<<<<<<< HEAD
## 1.获取数据

### 1.1 获取股票数据

#### 1.1.1 从网络获取股票数据

[quantmod](http://www.quantmod.com )包中的`getSymbols()`函数可以从网络上获取股票日交易数据。我们用`args()`函数看一下它的基本用法：


```r
install.packages("quantmod")
```

```
## Installing package into 'C:/Users/dengyishuo/Documents/R/win-library/3.0'
## (as 'lib' is unspecified)
```

```
## Error: trying to use CRAN without setting a mirror
```

```r
require(quantmod)
```

```
## Loading required package: quantmod
```

```
## Warning: there is no package called 'quantmod'
```

```r
args(getSymbols)
```

```
## Error: object 'getSymbols' not found
```


`getSymbols()`函数各参数的意义如下：

参数|用途
----|-------
Symbols|指定股票符号或者代码。
env|指定数据的存储位置。
reload.Symbols|是否重新载入数据到指定环境，缺省设置为FALSE。
warnings|是否打开警告提醒，缺省设置为TRUE。
src|获取股票数据的网址，缺省设置为yahoo，也可以选择google。
symbol.lookup|重设股票代码名称等。
auto.assign|结果是否自动载入工作环境。
file.path|文件路径。
...|其它参数。 

##### 1.1.1.1获取上证指数

上证指数的符号是^SSEC,获取上证指数的代码如下：

```
getSymbols("^SSEC")
```

也可以通过上证指数的代码来获取该数据。可以查到上证指数的代码为`000001.ss`，其中`.ss`代表该指数从属于上交所。代码如下：

```
getSymbols("000001.ss")
```

##### 1.1.1.2 获取上证A股指数

上证A股指数的代码为000002.ss。
值得指出的是，由于上证A股指数没有自己的符号，因此为了使用数据的方便，需要动用setSymbolLookup函数。

setSymbolLookup(A.Share.index=list(name="000002.ss",src="yahoo"))
getSymbols("A.Share.index")


##### 1.1.1.3 获取上证B股指数
上证B股指数的代码为000003.ss。

setSymbolLookup(B.Share.index=list(name="000003.ss",src="yahoo"))
getSymbols("B.Share.index")


##### 1.1.1.4 获取上证综合指数
上证综合指数的代码为000008.ss。

setSymbolLookup(Conglomerate.index=list(name="000008.ss",src="yahoo"))
getSymbols("Conglomerate.index")

获取沪深300指数}
沪深300指数的代码为000300.ss。

setSymbolLookup(CSI300=list(name="000300.ss",src="yahoo"))
getSymbols("CSI300")
CSI300

深圳成指}
深证成指的代码为399001.sz，其中.sz代表该指数从属于深交所。

setSymbolLookup(component.index=list(name="399001.sz",src="yahoo"))
getSymbols("component.index")
component.index

获取中国移动公司数据}
中国移动公司的符号是CHL。

getSymbols("CHL")


获取三一重工数据}
三一重工的股票代码为600030.ss。

setSymbolLookup(SANY.HEAVY=list(name="600030.ss",src="yahoo"))
getSymbols("SANY.HEAVY")
SANY.HEAVY


从数据库获取股票数据}
除了能从网站上直接获取股票数据外，quantmod包还提供了一系列从现有文件或者数据库读取OHLC股票数据的函数，列出如下：
\textcolor{blue}{getSymbols.csv()}：从csv文件读取OHLC数据
用args()函数查看\textcolor{blue}{getSymbols.csv()}的用法：



getSymbols.MySQL()：从MySQL数据库读取数据
getSymbols.SQLite()：从SQLite数据库读取数据
getSymbols.rda()：读取以.r格式存储的数据

获取和查看上市公司的财务报表}
获取财务报表的函数是：getFinancials}或者getFin}函数。

getFinancials('CHL')

结果：

[1] "CHL.f"

用view.Fin()函数查看财务报表数据

view.Fin(CHL.f)


获取上市公司股息数据
getDividends()函数可以获取上市公司的股息数据。

getDividends("CHL")


根据股息调整股票价格
adjustOHLC()函数可以对股票数据进行除息调整。

getSymbols("CHL", from="1990-01-01", src="yahoo")
head(CHL)
head(CHLL.a <- adjustOHLC(CHL))
head(CHL.uA <- adjustOHLC(CHL, use.Adjusted=TRUE))


获取股票分割数据
getSplits()函数可以获取上市公司的股票分割数据。

getSplits("MSFT")

从网络获取期权交易数据

AAPL.OPT <- getOptionChain("AAPL")
AAPL.OPTS <- getOptionChain("AAPL", NULL)



getSymbols("AAPL")
options.expiry(AAPL)
futures.expiry(AAPL)
AAPL[options.expiry(AAPL)]


从网络获取汇市数据
getFX()函数可以获取汇率数据。

getFX("USD/JPY")
getFX("EUR/USD",from="2005-01-01")

也可以：

getSymbols("USD/EUR",src="oanda")
getSymbols("USD/EUR",src="oanda",from="2005-01-01")

获取重金属交易数据
getMetals()函数可以获取重金属的交易数据。

getFX(c("gold","XPD"))
getFX("plat",from="2005-01-01")

获取美联储经济数据

getSymbols.FRED()函数可以获取美联储主页上的美国经济数据。

getSymbols('CPIAUCNS',src='FRED')


或者：

setSymbolLookup(CPIAUCNS='FRED')
getSymbols('CPIAUCNS')

其它函数
查看内存中的股票数据

getSymbols("CHL","000023.ss")
showSymbols(env=.GlobalEnv)

结果如下：
\textcolor{blue}{
3.SS       CHL
"yahoo"   "yahoo" 
}
从内存中移除股票数据


RemoveSymbols("CHL")
showSymbols(env=.GlobalEnv)



getQuote("AAPL")
getQuote("QQQQ;SPY;^VXN",what=yahooQF(c("Bid","Ask")))
standardQuote()
yahooQF()

attachSymbols()
